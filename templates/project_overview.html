<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <title>BPX Dashboard</title>
    <!-- plugins:css -->
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='assets/vendors/mdi/css/materialdesignicons.min.css') }}"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='assets/vendors/ti-icons/css/themify-icons.css') }}"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='assets/vendors/css/vendor.bundle.base.css') }}"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='assets/vendors/font-awesome/css/font-awesome.min.css') }}"
    />
    <!-- endinject -->
    <!-- inject:css -->
    <!-- Layout styles -->
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='assets/css/style.css') }}"
    />
    <!-- End layout styles -->
    <link
      rel="shortcut icon"
      href="{{ url_for('static', filename='assets/images/favicon.png') }}"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='assets/css/chatbot.css') }}"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/icon?family=Material+Icons"
    />
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <style type="text/css">
      .leftnavbarcolor {
        background: linear-gradient(46deg, #e38a2a, #f5d5a5);
      }
      .icon-cell {
        display: table-cell;
        width: 50px;
        height: 50px;
        text-align: center;
        vertical-align: middle;
      }
      .icon {
        font-size: 24px;
        margin: 6px;
      }
      .yellowcircle {
        color: yellow;
      }
      .graycircle {
        color: gray;
      }
      .check {
        color: green;
      }
      .cross {
        color: red;
      }

      .chart {
        display: flex;
        flex-direction: column;
      }

      .column {
        display: flex;
        margin: 5px 0;
      }

      .box {
        width: 20px;
        height: 20px;
        border: 1px solid black;
        margin-right: 2px;
      }

      .red {
        background-color: red;
      }

      .orange {
        background-color: orange;
      }

      .green {
        background-color: green;
      }

      .risk-analysis-container {
        display: flex;
        flex-direction: column;
        gap: 10px; /* Spacing between items */
      }

      .risk-analysis-item {
        display: flex;
        justify-content:space-between;
        align-items: center;
        gap: 10px;
        width:100%;
      }

      .label {
        flex-grow: 1; /* Label takes remaining space */
        text-align: left; /* Align label text to the left */
        font-weight: bold;
     }


      .chart.horizontal {
        display: flex;
        flex-direction: row;
        align-items:center;
      }
      .card {
        display:flex;
        flex-direction:column;
        height:100%
      }
      .card-body {
        flex:1;
      }

      /* a. Completion Percentage Display */
      .completion-percentage {
          text-align: center;
          margin-bottom: 10px;
          font-weight: bold;
          font-size: 14px;
      }

      /* b. Progress Bar Container */
      .progress-bar-container {
          position: relative;
          display:flex;
          align-items:center;
          justify-content:center;
          width: 100%;
          max-width: 300px;
          margin-bottom: 15px;
      }

      /* Progress Bar */
      .progress-bar {
          position: relative;
          width: 100%;
          height: 25px;
          background-color: lightgray;
          border-radius: 12.5px;
          overflow: hidden;
      }

      /* Budget Bar */
      .budget-bar {
          position: absolute;
          top: 0;
          left: 0;
          height: 100%;
          background-color: rgba(9, 88, 121, 0.8);
          width: {{ cashout_percentage }}%;
          border-radius: 12.5px 0 0 12.5px;
      }

      /* Completion Bar */
      .completion-bar {
          position: absolute;
          top: 0;
          left: 0;
          height: 100%;
          background-color: rgba(12, 186, 222, 1);
          width: {{ completion_percentage }}%;
          border-radius: 12.5px 0 0 12.5px;
      }

      /* c. Indicator for Accrual */
      .indicator {
          position: absolute;
          top: -5px; /* Adjust as needed */
          width: 2px;
          height: 35px; /* Height to extend above the bar */
          background-color: black;
          z-index: 3;
      }

      /* Milestone Dots */
      .milestone-dots {
          position: absolute;
          top: 35%;
          left: 5px;
          width: 100%;
          height: 0;
          display: flex;
          justify-content: space-between;
          transform: translateY(-50%);
          z-index: 5;
      }

      .milestone-dot {
          width: 10px;
          height: 10px;
          background-color: black;
          border-radius: 50%;
          z-index: 5;
      }

      .proress-bar-wrapper {
        display:flex;
        align-items:center;
        justify-content:center;
        gap:10px;
      }

      /* Milestone Dates */
      .start-date, .end-date {
        font-size: 12px;
        font-weight: bold;
        white-space: nowrap;
        padding: 2px 4px;
        border-radius: 4px;
      }

      .start-date {
          left: 0px;
          top:50%;
          margin-left:5px;
          transform: translateY(-50%); /* Center vertically */

      }

      .end-date {
          right:0px;
          margin-right:5px;
          top:50%;
          transform: translateY(-50%); /* Center vertically */

      }

      /* d. Labels for Budget and Actuals */
      .progress-bar-labels {
          position: relative;
          width: 100%;
          max-width: 300px;
          height: auto; /* Same as progress bar height */
          margin-top: 10px;
          text-align:center;
      }

      .label-container {
          position: absolute;
          top: calc(100% + 10px); /* Place the labels 15px below the bar */
          left: 50%;
          transform: translateX(-50%); /* Center the container horizontally */
          display: flex;
          gap: 20px; /* Add space between labels */
          align-items: center;
      }
      .date-label {
          position: absolute;
          font-size: 12px;
          font-weight: bold;
          white-space: nowrap;
          padding: 2px 4px;
          background-color: rgba(255, 255, 255, 0.8);
          border-radius: 4px;
      }
      .label {
          font-size: 12px;
          font-weight: bold;
          white-space: nowrap;
          padding: 2px 4px;
          background-color: rgba(255, 255, 255, 0.8);
          border-radius: 4px;
      }

      /* e. Responsive Adjustments */
      @media (max-width: 768px) {
          .progress-bar-container, .progress-bar-labels {
              max-width: 100%;
          }
          .completion-percentage {
              font-size: 12px;
          }
          .start-date, .end-date, .accrual-label {
              font-size: 10px;
          }
          .budget-label, .actuals-label {
              font-size: 10px;
          }
      }

      .segment {
        height: 100%;
        position: absolute;
        top: 0;
      }

      .pm-status-container {
        display: flex;
        flex-direction: column;
        align-items: flex-start; /* Align items vertically */
    }

    .pm-status-item {
        display: flex;
        justify-content:space-between;
        align-items: center;
        margin-bottom: 5px; /* Spacing between items */
        width:100%;
    }

    .pm-status-item .label {
        margin-right: 8px; /* Space between label and icon */
    }

    .icon {
        font-size: 16px;
    }

    .notes-container {
      margin-top: 10px;
    }

    ul {
      list-style-type: disc;
      padding-left: 20px;
    }

    ul li {
      margin-bottom: 5px;
    }

    .add-note {
      margin-top: 10px;
    }

    .delete-note {
      margin-left: 10px;
      color: red;
      cursor: pointer;
    }

    
    </style>
  </head>
  <body>
    <div class="container-scroller">
      <!-- partial:../../partials/_navbar.html -->
      <nav
        class="navbar default-layout-navbar col-lg-12 col-12 p-0 fixed-top d-flex flex-row"
      >
        <div
          class="text-center navbar-brand-wrapper d-flex align-items-center justify-content-start"
        >
          <a class="navbar-brand brand-logo" href="#"
            ><img
              src="{{ url_for('static', filename='assets/images/bpxlogo.svg') }}"
              alt="logo"
            />
          </a>
        </div>
        <div class="navbar-menu-wrapper d-flex align-items-stretch">
          <button
            class="navbar-toggler navbar-toggler align-self-center"
            type="button"
            data-toggle="minimize"
          >
            <span class="mdi mdi-menu"></span>
          </button>
          <div class="search-field d-none d-md-block">
            <form class="d-flex align-items-center h-100" action="#">
              <div class="input-group">
                <div class="input-group-prepend bg-transparent">
                  <i class="input-group-text border-0 mdi mdi-magnify"></i>
                </div>
                <input
                  type="text"
                  class="form-control bg-transparent border-0"
                  placeholder="Search projects"
                />
              </div>
            </form>
          </div>
          <ul class="navbar-nav navbar-nav-right">
            <li class="nav-item d-none d-lg-block full-screen-link">
              <a class="nav-link">
                <i class="mdi mdi-fullscreen" id="fullscreen-button"></i>
              </a>
            </li>
            <li class="nav-item dropdown">
              <a
                class="nav-link count-indicator dropdown-toggle"
                id="messageDropdown"
                href="#"
                data-bs-toggle="dropdown"
                aria-expanded="false"
              >
                <i class="mdi mdi-email-outline"></i>
                <span class="count-symbol bg-warning"></span>
              </a>
              <div
                class="dropdown-menu dropdown-menu-end navbar-dropdown preview-list"
                aria-labelledby="messageDropdown"
              >
                <h6 class="p-3 mb-0">Messages</h6>
                <div class="dropdown-divider"></div>
                <a class="dropdown-item preview-item">
                  <div class="preview-thumbnail">
                    <img
                      src="{{ url_for('static', filename='assets/images/faces/face4.jpg') }}"
                      alt="image"
                      class="profile-pic"
                    />
                  </div>
                  <div
                    class="preview-item-content d-flex align-items-start flex-column justify-content-center"
                  >
                    <h6
                      class="preview-subject ellipsis mb-1 font-weight-normal"
                    >
                      Mark send you a message
                    </h6>
                    <p class="text-gray mb-0">1 Minutes ago</p>
                  </div>
                </a>
                <div class="dropdown-divider"></div>
                <a class="dropdown-item preview-item">
                  <div class="preview-thumbnail">
                    <img
                      src="{{ url_for('static', filename='assets/images/faces/face2.jpg') }}"
                      alt="image"
                      class="profile-pic"
                    />
                  </div>
                  <div
                    class="preview-item-content d-flex align-items-start flex-column justify-content-center"
                  >
                    <h6
                      class="preview-subject ellipsis mb-1 font-weight-normal"
                    >
                      Cregh send you a message
                    </h6>
                    <p class="text-gray mb-0">15 Minutes ago</p>
                  </div>
                </a>
                <div class="dropdown-divider"></div>
                <a class="dropdown-item preview-item">
                  <div class="preview-thumbnail">
                    <img
                      src="{{ url_for('static', filename='assets/images/faces/face3.jpg') }}"
                      alt="image"
                      class="profile-pic"
                    />
                  </div>
                  <div
                    class="preview-item-content d-flex align-items-start flex-column justify-content-center"
                  >
                    <h6
                      class="preview-subject ellipsis mb-1 font-weight-normal"
                    >
                      Profile picture updated
                    </h6>
                    <p class="text-gray mb-0">18 Minutes ago</p>
                  </div>
                </a>
                <div class="dropdown-divider"></div>
                <h6 class="p-3 mb-0 text-center">4 new messages</h6>
              </div>
            </li>
            <li class="nav-item dropdown">
              <a
                class="nav-link count-indicator dropdown-toggle"
                id="notificationDropdown"
                href="#"
                data-bs-toggle="dropdown"
              >
                <i class="mdi mdi-bell-outline"></i>
                <span class="count-symbol bg-danger"></span>
              </a>
              <div
                class="dropdown-menu dropdown-menu-end navbar-dropdown preview-list"
                aria-labelledby="notificationDropdown"
              >
                <h6 class="p-3 mb-0">Notifications</h6>
                <div class="dropdown-divider"></div>
                <a class="dropdown-item preview-item">
                  <div class="preview-thumbnail">
                    <div class="preview-icon bg-success">
                      <i class="mdi mdi-calendar"></i>
                    </div>
                  </div>
                  <div
                    class="preview-item-content d-flex align-items-start flex-column justify-content-center"
                  >
                    <h6 class="preview-subject font-weight-normal mb-1">
                      Event today
                    </h6>
                    <p class="text-gray ellipsis mb-0">
                      Just a reminder that you have an event today
                    </p>
                  </div>
                </a>
                <div class="dropdown-divider"></div>
                <a class="dropdown-item preview-item">
                  <div class="preview-thumbnail">
                    <div class="preview-icon bg-warning">
                      <i class="mdi mdi-cog"></i>
                    </div>
                  </div>
                  <div
                    class="preview-item-content d-flex align-items-start flex-column justify-content-center"
                  >
                    <h6 class="preview-subject font-weight-normal mb-1">
                      Settings
                    </h6>
                    <p class="text-gray ellipsis mb-0">Update dashboard</p>
                  </div>
                </a>
                <div class="dropdown-divider"></div>
                <a class="dropdown-item preview-item">
                  <div class="preview-thumbnail">
                    <div class="preview-icon bg-info">
                      <i class="mdi mdi-link-variant"></i>
                    </div>
                  </div>
                  <div
                    class="preview-item-content d-flex align-items-start flex-column justify-content-center"
                  >
                    <h6 class="preview-subject font-weight-normal mb-1">
                      Launch Admin
                    </h6>
                    <p class="text-gray ellipsis mb-0">New admin wow!</p>
                  </div>
                </a>
                <div class="dropdown-divider"></div>
                <h6 class="p-3 mb-0 text-center">See all notifications</h6>
              </div>
            </li>
            <li class="nav-item nav-logout d-none d-lg-block">
              <a class="nav-link" href="#">
                <i class="mdi mdi-power"></i>
              </a>
            </li>
            <li class="nav-item nav-settings d-none d-lg-block">
              <a class="nav-link" href="#">
                <i class="mdi mdi-format-line-spacing"></i>
              </a>
            </li>
          </ul>
          <button
            class="navbar-toggler navbar-toggler-right d-lg-none align-self-center"
            type="button"
            data-toggle="offcanvas"
          >
            <span class="mdi mdi-menu"></span>
          </button>
        </div>
      </nav>
      <!-- partial -->
      <div class="container-fluid page-body-wrapper">
        <!-- partial:../../partials/_sidebar.html -->
        <nav class="sidebar sidebar-offcanvas" id="sidebar">
          <ul class="nav">
            <li class="nav-item">
              <a class="nav-link" href="/">
                <span class="menu-title">Dashboard</span>
                <i class="mdi mdi-home menu-icon"></i>
              </a>
            </li>
            <li class="nav-item leftnavbarcolor">
              <a class="nav-link" href="/projectoverview">
                <span class="menu-title">Project Overview</span>
                <i class="mdi mdi-view-list menu-icon"></i>
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/finance">
                <span class="menu-title">Financial Forecast</span>
                <i class="mdi mdi-elevation-rise menu-icon"></i>
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/projectactivity">
                <span class="menu-title">Project Activity</span>
                <i class="mdi mdi-calendar-text menu-icon"></i>
              </a>
            </li>
            <!-- <li class="nav-item">
              <a class="nav-link" href="/studytimeline2">
                <span class="menu-title">Project Study</span>
                <i class="mdi mdi-apps menu-icon"></i>
              </a>
            </li> -->
            <!-- <li class="nav-item">
              <a class="nav-link" href="/notes_issues">
                <span class="menu-title">Notes & Issue</span>
                <i class="mdi mdi-note-multiple menu-icon"></i>
              </a>
            </li> -->
			<li class="nav-item">
              <a class="nav-link" href="/studytimeline_v2">
                <span class="menu-title">Project Milestone</span>
                <i class="mdi mdi-flag-variant menu-icon"></i>
              </a>
            </li>
          </ul>
        </nav>
        <!-- partial -->
        <div class="main-panel">
          <div class="content-wrapper">
            <div class="page-header">
              <h3 class="page-title">Project Data</h3>
              <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                  <li class="breadcrumb-item"><a href="#">Tables</a></li>
                  <li class="breadcrumb-item active" aria-current="page">
                    Basic tables
                  </li>
                </ol>
              </nav>
            </div>
            <div class="row">
              <!-- CHATBOT -->
              <div id="chat-button" class="chat-button">ðŸ’¬</div>
              <div id="chat-box" class="chat-box">
                <div class="chat-header">
                  <h4>Chat</h4>
                  <button id="close-chat" class="close-chat">Ã—</button>
                </div>
                <div class="chat-content" id="chat-content"></div>
                <div class="chat-input">
                  <textarea
                    id="chatinputtext"
                    placeholder="Type your message..."
                  ></textarea>
                  <button id="send-button">Send</button>
                </div>
              </div>

              <!-- CHATBOT END -->
              <div class="col-lg-12 grid-margin stretch-card">
                <div class="card">
                  <div class="card-body">
                    <h4 class="card-title">Project Data Risk</h4>
                    <table class="table table-bordered">
                      <thead>
                        <tr>
                          <th
                            style="width: 130px"
                            title="Unique identifier for the project"
                          >
                            Project ID
                          </th>
                          <th title="Current status of the project">Status</th>
                          <th
                            style="width: 140px"
                            title="Project status for Overall, Scope, Schedule, and Budget (From left to right)"
                          >
                            PM Defined status
                          </th>
                          <th
                            title="Displays the budget, actual spend (chashout), and accrual for each project with a progress bar representation. Entire bar represents Actual percentage (actual / budget). Vertical bar represents accrual percentage (accrual/budget)"
                          >
                            Budget
                          </th>
                          <th
                            style="width: 110px"
                            title="Risk analysis based on project data for Pace, Execution, and Resources (From left to right)"
                          >
                            Risk Analysis
                          </th>
                          <th
                            title="Project issues, including severity and count"
                          >
                            Issues
                          </th>
                          <th
                            title="Click Add Note to add a new note to the project. Can add up to 5 notes for now"
                          >
                            Notes
                          </th>
                        </tr>
                      </thead>
                      <tbody>
                        {% for project_id, value in data1.items(): %}
                        <tr>
                          <td
                            style="
                              text-decoration: underline;
                              font-weight: bold;
                            "
                          >
                            {{ project_id }}
                          </td>

                          <!-- -->
                          {% if value['Status'] == 'Not Started' %}
                          <td style="width: 10%">
                            <span class="badge bg-secondary"
                              >{{value['Status']}}</span
                            >
                          </td>
                          {% elif value['Status'] == 'On Hold' %}
                          <td style="width: 10%">
                            <span class="badge" style="background: purple"
                              >{{value['Status']}}</span
                            >
                          </td>
                          {% elif value['Status'] == 'In Progress' %}
                          <td style="width: 10%">
                            <span class="badge bg-success"
                              >{{value['Status']}}</span
                            >
                          </td>
                          {% elif value['Status'] == 'At Risk' %}
                          <td style="width: 10%">
                            <span class="badge" style="background: orange"
                              >{{value['Status']}}</span
                            >
                          </td>
                          {% elif value['Status'] == 'Overdue' %}
                          <td style="width: 10%">
                            <span class="badge bg-danger"
                              >{{value['Status']}}</span 
                            >
                          </td>
                          {% elif value['Status'] == 'Cancelled' %}
                          <td style="width: 10%">
                            <span class="badge bg-warning"
                              >{{value['Status']}}</span
                            >
                          </td>
                          {% elif value['Status'] == 'Completed' %}
                          <td style="width: 10%">
                            <span class="badge bg-info"
                              >{{value['Status']}}</span
                            >
                          </td>
                          {% endif %}

                          <!--End -->

                          <td>
                            <div class="pm-status-container">
                                <!-- Overall -->
                                <div class="pm-status-item">
                                    <span class="label">Overall:</span>
                                    {% if value['Overall'] == 4 %}
                                    <span class="icon check">&#x2713;</span>
                                    {% elif value['Overall'] == 3 %}
                                    <span class="icon yellowcircle">&#x25CF;</span>
                                    {% elif value['Overall'] == 2 %}
                                    <span class="icon cross">&#x2717;</span>
                                    {% elif value['Overall'] == 1 %}
                                    <span class="icon graycircle">&#x25CF;</span>
                                    {% endif %}
                                </div>
                                <!-- Scope -->
                                <div class="pm-status-item">
                                    <span class="label">Scope:</span>
                                    {% if value['Scope'] == 1 %}
                                    <span class="icon check">&#x2713;</span>
                                    {% elif value['Scope'] == 2 %}
                                    <span class="icon yellowcircle">&#x25CF;</span>
                                    {% elif value['Scope'] == 3 %}
                                    <span class="icon cross">&#x2717;</span>
                                    {% elif value['Scope'] == 4 %}
                                    <span class="icon graycircle">&#x25CF;</span>
                                    {% endif %}
                                </div>
                                <!-- Schedule -->
                                <div class="pm-status-item">
                                    <span class="label">Schedule:</span>
                                    {% if value['Schedule'] < 0 %}
                                    <span class="icon cross">&#x2717;</span>
                                    {% elif value['Schedule'] <= 5 %}
                                    <span class="icon yellowcircle">&#x25CF;</span>
                                    {% elif value['Schedule'] > 5 %}
                                    <span class="icon check">&#x2713;</span>
                                    {% else %}
                                    <span class="icon graycircle">&#x25CF;</span>
                                    {% endif %}
                                </div>
                                <!-- Budget -->
                                <div class="pm-status-item">
                                    <span class="label">Budget:</span>
                                    {% if value['Budget'] > 0.75 %}
                                    <span class="icon check">&#x2713;</span>
                                    {% elif value['Budget'] > 0.5 %}
                                    <span class="icon yellowcircle">&#x25CF;</span>
                                    {% elif value['Budget'] <= 0.5 %}
                                    <span class="icon cross">&#x2717;</span>
                                    {% else %}
                                    <span class="icon graycircle">&#x25CF;</span>
                                    {% endif %}
                                </div>
                            </div>
                          </td>
                        

                          {% set cashout_percentage = (value['LT_Budget_Cashout'] / value['LT_Budget']) * 100 %}
                          {% set accrual_percentage = (value['LT_Budget_Accrual'] / value['LT_Budget']) * 100 %}
                          {% set completion_percentage = (value['milestonecompletion_per'])* 100 %}

                          {% set milestones = [
                              {"percent": 25, "name": "Milestone 1"},
                              {"percent": 50, "name": "Milestone 2"},
                              {"percent": 75, "name": "Milestone 3"}
                          ] %}

                          <td style="width:30%; position: relative;">
                            <!-- Completion Percentage Display -->
                            <div class="completion-percentage">
                                Project Milestone Completion: {{ completion_percentage| round(2) }}%
                            </div>
                            
                            <!-- Container for Dates and Progress Bar -->
                            <div class="progress-bar-wrapper" style="display: flex; align-items: center; justify-content: center;">
                                <!-- Start Date -->
                                <span class="date-label start-date">{{ value['startdate'] }}</span>
                                
                                <!-- Progress bar container with overlayed Budget and Completion Bars -->
                                <div class="progress-bar-container">
                                    <div class="progress-bar">
                                        <!-- Budget Bar (Actuals) -->
                                        <div class="budget-bar" style="width: {{ cashout_percentage }}%;" title="Actuals"></div>
                        
                                        <!-- Completion Bar -->
                                        <div class="completion-bar" style="width: {{ completion_percentage | round(2) }}%;" title="Project Completion">
                                            <!-- Milestone Dots -->
                                            <div class="milestone-dots">
                                                {% for milestone in milestones %}
                                                <div class="milestone-dot" style="left: {{ milestone.percent }}%;" title="{{ milestone.name }}"></div>
                                                {% endfor %}
                                            </div>
                                        </div>
                        
                                        <!-- Indicator for Accrual -->
                                        <div class="indicator" style="left: {{ accrual_percentage }}%;" title="Accrual"></div>
                                    </div>
                                  
                                    <!-- Labels for Budget, Actuals, and Accrual -->
                                    <div class="label-container">
                                        <span class="label">Budget: {{ value['labelbg'] }}</span>
                                        <span class="label">Actuals: {{ value['labelcas'] }}</span>
                                        <span class="label">Accrual: {{ value['labelacc'] }}</span>
                                    </div>
                                </div>
                                
                                <!-- End Date -->
                                <span class="date-label end-date">{{ value['enddate'] }}</span>
                            </div>
                        </td>
                        
                        
                                               
                          
                          <td>
                            <div class="risk-analysis-container">
                              <!-- Pace -->
                              <div class="risk-analysis-item horizontal">
                                <span class="label">Pace:</span>
                                <div class="chart horizontal">
                                  {% if value['Pace'] <= 0 %}
                                  <div class="box"></div><div class="box"></div><div class="box"></div><div class="box"></div><div class="box"></div>
                                  {% elif value['Pace'] <= 10 %}
                                  <div class="box green"></div><div class="box"></div><div class="box"></div><div class="box"></div><div class="box"></div>
                                  {% elif value['Pace'] <= 20 %}
                                  <div class="box orange"></div><div class="box orange"></div><div class="box"></div><div class="box"></div><div class="box"></div>
                                  {% elif value['Pace'] <= 30 %}
                                  <div class="box orange"></div><div class="box orange"></div><div class="box orange"></div><div class="box"></div><div class="box"></div>
                                  {% elif value['Pace'] <= 40 %}
                                  <div class="box red"></div><div class="box red"></div><div class="box red"></div><div class="box red"></div><div class="box"></div>
                                  {% else %}
                                  <div class="box red"></div><div class="box red"></div><div class="box red"></div><div class="box red"></div><div class="box red"></div>
                                  {% endif %}
                                </div>
                              </div>
                          
                              <!-- Execution -->
                              <div class="risk-analysis-item horizontal">
                                <span class="label">Execution:</span>
                                <div class="chart horizontal">
                                  {% if value['Execution'] <= 0 %}
                                  <div class="box"></div><div class="box"></div><div class="box"></div><div class="box"></div><div class="box"></div>
                                  {% elif value['Execution'] <= 10 %}
                                  <div class="box green"></div><div class="box"></div><div class="box"></div><div class="box"></div><div class="box"></div>
                                  {% elif value['Execution'] <= 20 %}
                                  <div class="box orange"></div><div class="box orange"></div><div class="box"></div><div class="box"></div><div class="box"></div>
                                  {% elif value['Execution'] <= 30 %}
                                  <div class="box orange"></div><div class="box orange"></div><div class="box orange"></div><div class="box"></div><div class="box"></div>
                                  {% elif value['Execution'] <= 40 %}
                                  <div class="box red"></div><div class="box red"></div><div class="box red"></div><div class="box red"></div><div class="box"></div>
                                  {% else %}
                                  <div class="box red"></div><div class="box red"></div><div class="box red"></div><div class="box red"></div><div class="box red"></div>
                                  {% endif %}
                                </div>
                              </div>
                          
                              <!-- Resources -->
                              <div class="risk-analysis-item horizontal">
                                <span class="label">Resources:</span>
                                <div class="chart horizontal">
                                  {% if value['Resources'] <= 0 %}
                                  <div class="box"></div><div class="box"></div><div class="box"></div><div class="box"></div><div class="box"></div>
                                  {% elif value['Resources'] <= 10 %}
                                  <div class="box green"></div><div class="box"></div><div class="box"></div><div class="box"></div><div class="box"></div>
                                  {% elif value['Resources'] <= 20 %}
                                  <div class="box orange"></div><div class="box orange"></div><div class="box"></div><div class="box"></div><div class="box"></div>
                                  {% elif value['Resources'] <= 30 %}
                                  <div class="box orange"></div><div class="box orange"></div><div class="box orange"></div><div class="box"></div><div class="box"></div>
                                  {% elif value['Resources'] <= 40 %}
                                  <div class="box red"></div><div class="box red"></div><div class="box red"></div><div class="box red"></div><div class="box"></div>
                                  {% else %}
                                  <div class="box red"></div><div class="box red"></div><div class="box red"></div><div class="box red"></div><div class="box red"></div>
                                  {% endif %}
                                </div>
                              </div>
                            </div>
                          </td>
                          
                          
                          
                                    
                                  <td> 
                                  {% if value['Issues'] == 'L' %}   
                                   <div style="color: green; font-weight: bold;">L &#x2198;</div>
                                      {% elif value['Issues'] == 'M' %}
                                          <div style="color: orange; font-weight: bold;">M &#x2192;</div>
                                      {% elif value['Issues'] == 'H' %}
                                          <div style="color: red; font-weight: bold;">H &#x2197;</div>
                                      {% elif value['Issues'] == 'Critical' %}
                                          <div style="color: black; font-weight: bold;">Critical &#x2191;</div>
                                      {% else %}
                                          <div>{{ value['Issues'] }}</div>
                                      {% endif %}
                                  <div>{{ value['IssuesCount'] }}</div>
                                  </td>
                          <td>
                          <!-- Notes section -->
                          <div class="notes-container">
                            <ul id="notes-list-{{ project_id }}"></ul> <!-- List of notes -->
                            <button class="btn btn-primary add-note" data-project-id="{{ project_id }}">Add Note</button>
                          </div>
                        </td>
                        </tr>
                        {% endfor %}
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>

              <!-- -->
            </div>
          </div>
          <!-- content-wrapper ends -->
          <!-- partial:../../partials/_footer.html -->
          <footer class="footer">
            <div
              class="d-sm-flex justify-content-center justify-content-sm-between"
            >
              <span
                class="text-muted text-center text-sm-left d-block d-sm-inline-block"
                ><h4>BPX Team</h4></span
              >
              <span
                class="float-none float-sm-right d-block mt-1 mt-sm-0 text-center"
                >helpdesk@bpx.ai</span
              >
            </div>
          </footer>
          <!-- partial -->
        </div>
        <!-- main-panel ends -->
      </div>
      <!-- page-body-wrapper ends -->
    </div>
    <!-- container-scroller -->
    <!-- plugins:js -->
    <script src="{{ url_for('static', filename='assets/js/chatbot.js') }}"></script>
    <script src="{{ url_for('static', filename='assets/vendors/js/vendor.bundle.base.js') }}"></script>
    <!-- endinject -->
    <!-- inject:js -->
    <script src="{{ url_for('static', filename='assets/js/off-canvas.js') }}"></script>
    <script src="{{ url_for('static', filename='assets/js/misc.js') }}"></script>
    <script src="{{ url_for('static', filename='assets/js/settings.js') }}"></script>
    <script src="{{ url_for('static', filename='assets/js/todolist.js') }}"></script>
    <script src="{{ url_for('static', filename='assets/js/jquery.cookie.js') }}"></script>
    <!-- endinject -->
    <script>
      document.addEventListener("DOMContentLoaded", function () {
  // Get the width percentages of the bars
      const budgetBar = document.querySelectorAll(".budget-bar");
      const completionBar = document.querySelectorAll(".completion-bar");
      
      // Loop through each budget and completion bar pair
      budgetBar.forEach((budget, index) => {
        const budgetPercentage = parseFloat(budget.style.width);
        const completionPercentage = parseFloat(completionBar[index].style.width);

        // Assign z-index dynamically: lower percentage gets higher z-index (appears on top)
        if (budgetPercentage > completionPercentage) {
          budget.style.zIndex = 1;
          completionBar[index].style.zIndex = 2;
        } else if (budgetPercentage < completionPercentage) {
          budget.style.zIndex = 2;
          completionBar[index].style.zIndex = 1;
        } else {
          // When percentages are equal, keep the completion bar on top
          budget.style.zIndex = 1;
          completionBar[index].style.zIndex = 2;
        }
        
        // Ensure both bars are always visible by adding a minimum width
        if (budgetPercentage === 0) {
          budget.style.width = "1%";
        }
        if (completionPercentage === 0) {
          completionBar[index].style.width = "1%";
        }
      });
    });

    </script>
    
    <script>
      document.addEventListener("DOMContentLoaded", function () {
  // Handle adding notes
      document.querySelectorAll('.add-note').forEach(function (button) {
        button.addEventListener('click', function () {
          const projectId = this.getAttribute('data-project-id');
          const notesList = document.getElementById(`notes-list-${projectId}`);

          // Get the number of existing notes
          const existingNotes = notesList.getElementsByTagName('li').length;

          // Check if the limit of 5 notes is reached
          if (existingNotes >= 5) {
            alert('You cannot add more than 5 notes.');
            return;
          }

          // Prompt user for note input
          const noteText = prompt("Enter your note (max 250 characters):");

          // Validate note input
          if (noteText && noteText.length <= 250) {
            // Create new list item for the note
            const noteItem = document.createElement('li');
            noteItem.innerHTML = `${noteText} <button class="delete-note">Delete</button>`;

            // Add delete functionality
            noteItem.querySelector('.delete-note').addEventListener('click', function () {
              notesList.removeChild(noteItem);
              button.disabled = false; // Re-enable the Add Note button if a note is deleted
            });

            // Append note to the list
            notesList.appendChild(noteItem);

            // Disable the Add Note button if 5 notes are reached
            if (existingNotes + 1 >= 5) {
              button.disabled = true;
            }
          } else {
            alert('Please enter a valid note (maximum 250 characters).');
          }
        });
      });
    });

    </script>
  </body>
</html>
